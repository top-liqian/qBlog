## 1. 现代浏览器在与服务器建立了一个 TCP 连接后是否会在一个 HTTP 请求完成后断开？什么情况下会断开？

> 不会断开，早在`http/1.0`中，一个服务器发送完`HTTP`请求后，`TC`就会断开链接。但是每次请求都会重新建立和断开TCP连接，代价太大了。http/1.1将`Connection` 头写进标准，并且默认保持开启持久化连接，除非请求中声明` Connection: close`, 否则浏览器和服务器之间是会持续一段时间的`TCP`连接，不会一个请求就结束掉。

答： 默认情况下建立的`TCP`连接不会自动断开，除非将请求头中的`Connection`设置成`close`状态才会才请求完成后关闭连接

## 2. 一个 TCP 连接可以对应几个 HTTP 请求？

答：如果是持久连接的情况下，一个`TCP`连接可以对应多个`HTTP`请求

## 3. 一个 TCP 连接中 HTTP 请求发送可以一起发送么（比如一起发三个请求，再三个响应一起接收）？

> `http/1.1`协议中，单个`TCP`连接只能一次处理一个`HTTP`请求，也就是说两个请求的生命周期不能重叠，任意两个HTTP请求从开始到结束在同一个TCP连接里不能重叠，虽然`http/1.1`规范中规定了`Pipelining`但是默认浏览器是关闭这个功能的。`Pipelining`是一个支持持久化连接的客户端可以在一个连接中发送多个请求，收到的请求的服务器必须按照请求收到的顺序发送响应。至于为什么这样设定，原因在于由于 `HTTP/1.1 `是个文本协议，同时返回的内容也并不能区分对应于哪个发送的请求，所以顺序必须维持一致。`Pipelining`存在两个问题，一些代理服务器不能正确的处理 `HTTP Pipelining`；正确的流水线实现是复杂的。

> http2.0 提供了 `multiplexing` 多路传输特性，可以在`一个TCP`连接中同时完成`多个HTTP`请求。

答： `http/1.1`协议存在`Pipelining`技术可以完成这个多个请求同时发送，但是由于浏览器默认是关闭的，所以认为这并不是可行的。在`http2.0`提供了Multiplexing，多个`HTTP`请求可以在同一个`TCP`连接中并行进行。

## 4. 在 HTTP/1.1 时代，浏览器是如何提高页面加载效率的呢？

1. 维持和服务器已经建立的 `TCP` 连接，在同一连接上顺序处理多个请求。
2. 和服务器建立多个 `TCP` 连接。

## 5. 为什么有的时候刷新页面不需要重新建立 SSL 连接？

答案：`TCP`连接有的时候会被浏览器和服务端维持一段时间。`TCP`不需要重新建立，`SSL`自然也会用之前的。

## 6. 浏览器对同一Host建立TCP连接到数量有没有限制？

答案：有。`Chrome`最多允许对同一个 `Host` 建立`六`个 `TCP` 连接。不同的浏览器有一些区别；

## 7. 收到的 HTML 如果包含几十个图片标签，这些图片是以什么方式、什么顺序、建立了多少连接、使用什么协议被下载下来的呢？

答案：

如果图片都是`HTTPS`连接并且在`同一个域名`下，那么浏览器在`SSL`握手之后就会跟服务器商量能不能使用`HTTP2.0`，如果能的话就是用`Multiplexing`功能在这个连接上进行多路传输。不过也未必会所有挂在这个域名的资源都会使用一个` TCP `连接去获取，但是可以确定的是 `Multiplexing` 很可能会被用到。

如果只能使用`http/1.1`，那浏览器就会在一个`host`上建立多个`TCP`连接，连接的数量的最大限制取决于浏览器设置，这些连接会在空闲的时候被浏览器用来发送新的请求。


## 8. TCP的流量控制机制

为了让发送方发送数据的速度不要太快，要让接收方来得及接收。TCP采用大小可变的滑动窗口进行流量控制，窗口大小（每次传输的数据大小）的单位是字节

+ 当一个连接建立时，连接的每一端分配一个缓冲区来保存输入的数据，并将缓冲区的大小发送给另一端。
+ 当数据到达时，接收方发送确认，其中包含了自己剩余的缓冲区大小。（剩余的缓冲区空间的大小被称为窗口，指出窗口大小的通知称为窗口通告 。接收方在发送的每一确认中都含有一个窗口通告。）
+ 如果接收方应用程序读数据的速度能够与数据到达的速度一样快，接收方将在每一确认中发送一个正的窗口通告。
+ 如果发送方操作的速度快于接收方，接收到的数据最终将充满接收方的缓冲区，导致接收方通告一个零窗口 。发送方收到一个零窗口通告时，必须停止发送，直到接收方重新通告一个正的窗口。

## 9. TCP和UDP最大的区别是什么?

UDP：无连接，不可靠传输，不使用流量控制和拥塞控制，支持一对一，一对多，多对一和多对多交互通信，采用面向报文的传输方式且首部开销小，仅8字节，适用于实时应用，例如视频会议、直播

TCP：面向连接，可靠传输（数据顺序和正确性），使用流量控制和拥塞控制，只能是一对一通信，采用面向字节流的传输方式且首部最小20字节，最大60字节，适用于要求可靠传输的应用，例如文件传输